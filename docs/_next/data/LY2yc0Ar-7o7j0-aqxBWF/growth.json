{"initialProps":{"appProps":{}},"initialState":{"scriptSnippet":{"ids":[],"entities":{}},"variable":{"ids":[],"entities":{}},"scriptType":[],"scriptDatabase":[],"choiceControl":{"ids":[],"entities":{}},"step":{"steps":{}},"databaseScript":{"scripts":{}}},"__N_SSG":true,"pageProps":{"yamlData":{"steps":[{"id":"begin","check":{"script":{"db":"drupal","snippets":["set_email_var"]}},"delete":{"script":{"db":"drupal","snippets":["set_request_number","set_user_id_var","compose_email_placeholder","compose_text_placeholder"]}}},{"id":"users","check":{"description":"check if the email is in users table in bidata DB\n","script":{"db":"drupal","snippets":["set_email_var","find_user_id","show_user_id"]}},"delete":{"description":"create sql to \"delete\" in users table\n","script":{"db":"drupal","snippets":["update_placeholder_in_users"]}}},{"id":"sessions","check":{"description":"check if the user id is in sessions table in sessions DB\n","script":{"db":"sessions","snippets":["set_user_id_var","find_sessions"]}}},{"id":"friend_email","check":{"description":"check if the email is in friend_email table in bidata DB\n","script":{"db":"drupal","snippets":["set_email_var","find_friend_email_id","find_friend_email"]}}},{"id":"friend_address","check":{"description":"check if the friend email id is in friend_address table in bidata DB\n","script":{"db":"drupal","snippets":["set_email_var","find_friend_email_id","find_friend_address_id","find_friend_address"]}}},{"id":"minted_account","check":{"description":"check if the user id is in minted_account table in bidata DB\n","script":{"db":"drupal","snippets":["set_user_id_var","find_minted_account"]}}}],"types":["check","delete","Validation"],"db":["drupal","sessions","di","jobs","di_jobs"],"vars":{"email":{"description":"email address from OneTrust\n"},"requestNumber":{"description":"request number from OneTrust\n"},"userId":{"description":"user id from the main drupal database\n"},"emailPlaceholder":{"description":"placeholder to replace email reference\n"},"textPlaceholder":{"description":"placeholder to replace text reference\n"}},"snippets":{"set_email_var":"set @email = {{email}};\n","find_user_id":"select uid into @UID from users where mail = @email;\n","show_user_id":"select @UID;\n","set_request_number":"set @requestnumber = {{requestNumber}};\n","set_user_id_var":"set @UID = {{userId}};\n","compose_email_placeholder":"select concat(\"deleted-onetrust-req-\", @requestnumber, \"@privacy.mntd.net\") into @emailplaceholder;\n","compose_text_placeholder":"select concat(\"Deleted per onetrust\", @requestnumber) into @textplaceholder;\n","update_placeholder_in_users":"update users\nset\nname = @textplaceholder,\ninit = @textplaceholder,\nmail = @emailplaceholder,\npass = textplaceholder,\nwhere uid = @UID;\n","find_sessions":"select * from sessions where uid = @UID;\n","find_friend_email_id":"select id into @friendemailid from friend_email where email = @email;\n","find_friend_email":"select * from friend_email where id = @friendemailid;\n","find_friend_address_id":"select friend_address_id into @friend_address_id\nfrom friend_email where id = @friendemailid;\n","find_friend_address":"select * from friend_address where id = @friendaddressid;\n","find_minted_account":"select * from minted_account where user_id = @UID;\n"}},"aspect":"growth"}}